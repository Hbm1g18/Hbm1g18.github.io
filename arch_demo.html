<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link  href="style.css" rel="stylesheet">
    <meta name="viewport" content="initial-scale=1, width=device-width">
    <link  href="style.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <title>Drayton Arch 3D Mesh</title>
    <style>
        body { margin: 0; }
    </style>
  <script type="module" crossorigin src="/assets/index-CyE8K1ti.js"></script>
</head>
<body>

  <div class="menu">
    <div id="left-side">
        <div class="logo-holder">
            <img src="images/logo.png" id="logo" alt="">
        </div>
    </div>
    <div id="right-side">
        <div class="menucontainer" id="homebox">
            <a href="index.html"><div class="container-text">Home</div></a>
            <div class="scroller-holder">
                <div class="scroller"></div>
            </div>
        </div>
        <div class="menucontainer" id="projectbox">
          <a href="projects.html"><div class="container-text">Projects</div></a>
          <div class="scroller-holder">
              <div class="scroller"></div>
          </div>
      </div>
      <div class="menucontainer" id="aboutbox">
          <!-- THIS NEEDS EDITING -->
          <div class="container-text">About</div>
          <div class="scroller-holder">
              <div class="scroller"></div>
          </div>
      </div>
        <div class="mobile-box">
            <i class="fa fa-bars"></i>
        </div>
    </div>
  </div>


  <div class="container">

    <div class="header_area">
        <h1>Drone Captured 3D Mesh Visualisation</h1>
        <img src="images/rendered_both.png" class="post_img" alt="Drayton Arch Mesh">
        <p1>Using drone captured imagery to recreate 3D models as meshes. Creating scenes for viewing in Blender or on the web.</p1>
    </div>
    <div class="body_post">
        <hr>
        <div class="body_section">
            <h class="section_ttl">
                Drone Photogrammetry Processing
            </h>
            <p class="section_body">
                For the example mesh of Drayton Arch, 72 photographs were processed. 
                Photos were taken with a DJI Mavic 3E flown manually with varying camera angles. 
                Photos taken attempt to cover the full extent of the structure as much as possible at different viewing angles for more precise mesh generation.
            </p>
            <h class="section_ttl">
                1)
            </h>
            <p class="section_body">
                There are a number of processing software available for this project.
                This example uses both <a class="blue" href="https://www.pix4d.com/product/pix4dmapper-photogrammetry-software/">Pix4D Mapper</a> and <a class="blue" href="https://github.com/alicevision/Meshroom">Meshroom</a> (Opensource project).
                The image directory was brought in where both programs read the metadata to extract information regarding the photos.
                Meshroom is more suited for producing mesh objects - as the name implies. It is possible to retrieve the pointcloud information from this but the intention of the project is the mesh. 
                Georeferencing was also not completed in Meshroom. For this, Pix4D is best. However, in this project no ground control was used as just producing a high resolution mesh was the goal.
            </p>
            <h1>INCLUDE A SCREENIE OF PIX4D AND MESHROOM HERE</h1>
            <p class="section_body">
                For creating just a mesh from the captured imagery the process is quite automated from here. After changing a few settings to increase point cloud density and number of matches,
                 the images were processed by the program to produce both an RGB point cloud as well as a textured mesh as .obj file. Playing around with point cloud data will be covered in another post.
            </p>
            <h class="section_ttl">
                2)
            </h>
            <p class="section_body">
                Once the processing has finished, the mesh file will be generated as .obj with a texture JPEG or PNG which is used by the .mtl file.
                This is now able to be viewed in various programs such as <a class="blue" href="https://www.danielgm.net/cc/">CloudCompare</a>, <a class="blue" href="https://www.blender.org">Blender</a> or even within Pix4d/Meshroom themselves.
                This could be the end result and left here. But I will look at creating a scene for rendering images or hosting on the web as in the example below.
            </p>
            <p class="section_body">
                Within Blender the .obj file was imported. It may seem like there is no texture but this is shown in rendered view to save on resources. I have added in a basemap using 
                the blender addon 'Blender GIS'. More information on this addon will be available in a future post. 
                Using Blender GIS I have added two meshes with both Google Earth satellite imagery and OSM imagery draped onto it.
                The image below shows the Google Earth result whereas the interactive example below is using the OSM drape.
            </p>
            <p class="section_body_left">
                Blender was also used to create the animation in the video below. By setting keyframes at
                camera positions along a generated path, the relevant image frames were able to be rendered and put together in
                 video editing software. Blender can also be explored for more options in lighting and bringing in other components.
            </p>
            <img src="images/Textured.png" class="post_img_right" alt="Drayton Arch Mesh">
            <div class="video_holder_post">
                <video width="100%" height="100%" controls>
                    <source src="videos/ArchwayVideo.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <h class="section_ttl">
                3)
            </h>
            <p class="section_body">
                Preparing the files for the web was done using <a class="blue" href="https://threejs.org">ThreeJS</a> - a 3D Javascript library.
                A webserver was required for hosting the files to work with ThreeJS and so this was done using <a class="blue" href="https://vitejs.dev">Vite</a>.
                Following the documentation provided, I have used .glb files. For this the files were exported from Blender. 
                The .obj files can be used within ThreeJS using an object loader.
            </p>
            <p class="section_body">
                The demo below is using <a class="blue" href="https://pages.github.com">Github Pages</a>, as is all of this site, and so due to file size limitations I have had to slice the mesh
                into a number of pieces due to the complexity. This was also done in Blender before exporting each file as a .glb.
                Using Blender GIS I have brought in OSM building footprints to bring more depth to the distance of the model.
            </p>
            <p class="section_body">
                It is important to remember that ThreeJS uses Y as the upward direction. This is something I overlook when first working with it, 
                leading to a lot of confusion when bringing in models. As such, the Z axis you may be familiar with using for 3D space is now the Y.
            </p>
            <p class="section_body">
                Finally, scene lighting and a camera with controls needs to be set up to allow the user to see the model and navigate around.
                In my example I have gone for Trackball controls. Alternatively, if you choose to follow <a class="blue" href="https://threejs.org/docs/index.html#manual/en/introduction/Creating-a-scene">this</a>
                example in the documentation you will have a model with a static view that slowly spins in space. Further implementations
                may look at using <a class="blue" href="https://cesium.com">Cesium</a> 3D tilesets rather than our rough mesh from Blender.
                This model has also ignored georeferencing. More useful tools and analysis could be carried out with the models in the correct location geospatially.
                This is something that will be explored more using Pointclouds in the future.
            </p>
            <p class="section_body">
                Hopefully this short overview has given you an insight into using your captured imagery to produce a 3D mesh and a start into using ThreeJS to make interactive products.
            </p>
        </div>
    </div>



    <div id="Canvas"></div>

    <div id="footer">
        <hr>
        <div id="footercontents">
            <a href="https://www.linkedin.com/in/harry-bonshor-mayes-5a2236199/">LinkedIn</a>
        </div>
    </div>


  </div>

        <script src="menubar.js"></script>
        <!-- Handles highlight bars under topmenu -->
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                var menuContainers = document.querySelectorAll('#right-side .menucontainer');

                menuContainers.forEach(function(menuContainer) {
                    var containerText = menuContainer.querySelector('.container-text');
                    var scrollerHolder = menuContainer.querySelector('.scroller-holder');

                    var containerTextWidth = window.getComputedStyle(containerText).width;
                    // Set the width of .scroller-holder to match the width of .container-text
                    scrollerHolder.style.width = containerTextWidth;
                });
            });
        </script>
        <!-- Handles window resize and top menu accessibility -->
        <script>
            function handleResize() {
                var windowWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
        
                var menuContainers = document.querySelectorAll('#right-side .menucontainer');
                var hamburger = document.querySelector('.mobile-box');
                var rightside = document.getElementById('right-side');
                var containerBoxes = document.querySelectorAll('.container .container-box');
                var small_logo = document.querySelector('.logo-holder');
        
                menuContainers.forEach(function(menuContainer) {
        
                    if (windowWidth < 900) {
                        menuContainer.style.display = 'none';
                        hamburger.style.display = 'flex';
                        rightside.style.justifyContent = 'right';
                        small_logo.style.top = '0';
        
                        // Set the width of each .container-box to 98vw
                        containerBoxes.forEach(function(containerBox) {
                            containerBox.style.width = '98%';
                        });
                    } else {
                        menuContainer.style.display = '';
                        hamburger.style.display = '';
                        rightside.style.justifyContent = 'space-evenly';
                        small_logo.style.top = '50'
        
                        // Reset the width of each .container-box
                        containerBoxes.forEach(function(containerBox) {
                            containerBox.style.width = '';
                        });
                    }
                });
            }
        
            handleResize();
        
            window.addEventListener('resize', handleResize);
        </script>


</body>
</html>